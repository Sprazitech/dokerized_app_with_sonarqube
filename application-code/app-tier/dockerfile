# Use official Node 18 image
FROM node:18

# Install bash and MySQL client
RUN apt-get update && apt-get install -y bash default-mysql-client && rm -rf /var/lib/apt/lists/*

# Set working directory
WORKDIR /app

# Copy package.json and install dependencies
COPY package*.json ./
RUN npm install

# Copy the rest of the app code
COPY . .

# Make wait.sh executable
RUN chmod +x wait.sh

# Expose backend port
EXPOSE 4000

# Default command: run wait.sh to wait for MySQL before starting backend
CMD ["bash", "./wait.sh"]
